(function() {
  var BookLine, FormBook,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  BookLine = (function() {
    var comments, date, hasBeenGroomed, hasHadBreakfast, hasWokenUp, isShoppingDone, link, name;

    date = null;

    name = null;

    link = null;

    hasWokenUp = null;

    hasBeenGroomed = null;

    isShoppingDone = null;

    hasHadBreakfast = null;

    comments = null;

    function BookLine(config) {
      this.load = __bind(this.load, this);
      this.save = __bind(this.save, this);
      config = $.extend({
        'name': '',
        'link': '',
        'hasWokenUp': false,
        'hasBeenGroomed': false,
        'isShoppingDone': false,
        'hasHadBreakfast': false,
        'comments': ''
      }, config);
      this.date = new Date();
      this.name = config.name;
      this.link = config.link;
      this.hasWokenUp = config.hasWokenUp;
      this.hasBeenGroomed = config.hasBeenGroomed;
      this.isShoppingDone = config.isShoppingDone;
      this.hasHadBreakfast = config.hasHadBreakfast;
      this.comments = config.comments;
      return this;
    }

    BookLine.prototype.save = function(key) {
      localStorage.setObject(key, this);
      return this;
    };

    BookLine.prototype.load = function(key) {
      var data;
      data = localStorage.getObject(key);
      this.date = data.date;
      this.name = data.name;
      this.link = data.link;
      this.hasWokenUp = data.hasWokenUp;
      this.hasBeenGroomed = data.hasBeenGroomed;
      this.isShoppingDone = data.isShoppingDone;
      this.hasHadBreakfast = data.hasHadBreakfast;
      this.comments = data.comments;
      return this;
    };

    return BookLine;

  })();

  FormBook = (function() {
    var formEl, listEl;

    formEl = null;

    listEl = null;

    function FormBook(config) {
      this.bind = __bind(this.bind, this);
      config = $.extend({
        'formElId': '',
        'listElId': ''
      }, config);
      this.formEl = $(config.formElId);
      this.listEl = $(config.listElId);
      this.bind();
      return this;
    }

    FormBook.prototype.bind = function() {
      var _this = this;
      this.formEl.on({
        'submit': function(event) {
          var bookLine, col1, col2, col3, col4, data, date, newLineEl;
          console.log('form new line submit');
          event.preventDefault();
          data = {
            'hasWokenUp': false,
            'hasBeenGroomed': false,
            'isShoppingDone': false,
            'hasHadBreakfast': false,
            'comments': ''
          };
          _this.formEl.find('input:checkbox').each(function() {
            return data[$(this).data('field-name')] = $(this).is(':checked');
          });
          _this.formEl.find('input:text, textarea, select').each(function() {
            return data[$(this).data('field-name')] = $(this).val();
          });
          bookLine = new BookLine({
            'name': 'Moi',
            'link': 'AD',
            'hasWokenUp': data.hasWokenUp,
            'hasBeenGroomed': data.hasBeenGroomed,
            'isShoppingDone': data.isShoppingDone,
            'hasHadBreakfast': data.hasHadBreakfast,
            'comments': data.comments
          });
          date = new Date();
          bookLine.save('info-' + date.getTime());
          newLineEl = $('<tr>', {
            'class': 'success'
          });
          col1 = $('<a>', {
            'href': '#modal-info',
            'data-toggle': 'modal'
          });
          col1.html($('<p>').html($('<i>', {
            'class': 'glyphicon glyphicon-plus-sign'
          })));
          col2 = $('<a>', {
            'href': '#modal-info',
            'data-toggle': 'modal'
          });
          col2.html($('<p>').html(bookLine.date.getDate() + '/' + bookLine.date.getMonth() + 1));
          col3 = $('<a>', {
            'href': '#modal-info',
            'data-toggle': 'modal'
          });
          col3.html($('<p>').html(bookLine.name));
          col4 = $('<a>', {
            'href': '#modal-info',
            'data-toggle': 'modal'
          });
          col4.html($('<p>').html(bookLine.link));
          newLineEl.append($('<td>').html(col1), $('<td>').html(col2), $('<td>').html(col3), $('<td>').html(col4));
          _this.listEl.append(newLineEl);
          $('#modal-new').modal('hide');
          return _this;
        }
      });
      return this;
    };

    return FormBook;

  })();

  $(function() {
    var __form_book__;
    return __form_book__ = new FormBook({
      'formElId': '#form-new-line',
      'listElId': '#history-list'
    });
  });

}).call(this);
