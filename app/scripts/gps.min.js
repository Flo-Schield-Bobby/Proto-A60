(function() {
  var GPS,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  GPS = (function() {
    var map, rootEl, zoom;

    rootEl = null;

    map = null;

    zoom = null;

    function GPS(config) {
      this.navigateToCoords = __bind(this.navigateToCoords, this);
      this.bind = __bind(this.bind, this);
      this.init = __bind(this.init, this);
      config = $.extend({
        'rootElId': '',
        'zoom': 15
      }, config);
      this.rootEl = $(config.rootElId);
      this.zoom = config.zoom;
      this.init();
      return this;
    }

    GPS.prototype.init = function() {
      if (window.L) {
        this.map = L.mapbox.map(this.rootEl.attr('id'), 'floschieldbobby.go9bj0m8');
        this.navigateToCoords(49.4165, 2.8215, this.zoom);
        this.bind();
      }
      return this;
    };

    GPS.prototype.bind = function() {
      var _this = this;
      $(window).on({
        'map.setview': function(e, params) {
          if (typeof params === 'object' && params.lat && params.lng) {
            params.zoom = params.zoom || _this.zoom;
            return _this.navigateToCoords(params.lat, params.lng, params.zoom);
          }
        }
      });
      return this;
    };

    GPS.prototype.navigateToCoords = function(lat, lng, zoom) {
      zoom = zoom || this.zoom;
      this.map.setView([lat, lng], zoom);
      return this;
    };

    return GPS;

  })();

  $(function() {
    var __gps__;
    return __gps__ = new GPS({
      'rootElId': '#gps',
      'zoom': 16
    });
  });

}).call(this);
